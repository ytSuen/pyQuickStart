# pyQuickStart v2.0.1 发布说明

发布日期：2026-01-28

## 🎉 版本亮点

本次更新主要优化了防锁屏功能的可靠性和日志管理系统，修复了多个重要bug。

## ✨ 新增功能

### 1. 优化日志管理系统
- **新命名格式**：日志文件改为 `pyQuickStart_yyyymmdd.log`
- **自动日期切换**：0点后自动切换到新日期的日志文件
- **自动清理**：保留最近7天日志，自动删除过期日志
- **兼容旧格式**：支持清理旧的 `hotkey_*.log` 格式日志

### 2. 应用图标
- 使用自定义图标（resources/SYT.ico）
- 打包后的exe文件显示专属图标

## 🐛 Bug修复

### 1. 防锁屏功能优化
- **改进鼠标移动策略**：增加延迟时间到150ms，使用相对移动确保系统识别为用户活动
- **改进按键模拟**：使用F15键替代Shift键，避免影响用户操作，按键持续时间增加到50ms
- **调整执行顺序**：将按键模拟提升为最高优先级

### 2. 修复运行中程序计数错误
- **问题**：Chrome/Edge等多进程浏览器会创建多个子进程，导致计数不准确
- **修复**：识别并只统计主进程（通过启动时间判断）
- **支持已运行进程**：浏览器已运行时也能正确添加到监控列表

### 3. 修复日志切换bug
- **问题**：日期变更后仍然写入旧日志文件
- **原因**：logging.basicConfig()在root logger上添加handlers，导致handler重复
- **修复**：改为手动配置独立logger，设置propagate=False，确保只写入新文件

## 📝 详细更新日志

### 防锁屏功能
```
优化前：
- 鼠标移动后立即用SetCursorPos跳回原位
- 使用Shift键，持续时间1ms
- 鼠标移动优先级最高

优化后：
- 鼠标移动后等待150ms，使用相对移动回原位
- 使用F15键（不影响用户操作），持续时间50ms
- 按键模拟优先级最高
```

### 进程统计
```
修复前：
- 启动1个Chrome显示8个进程
- 启动1个Edge显示6个进程
- 浏览器已运行时无法添加到监控

修复后：
- 启动1个Chrome显示1个进程（主进程）
- 启动1个Edge显示1个进程（主进程）
- 浏览器已运行时自动找到并添加主进程
```

### 日志管理
```
改进前：
- 文件名：hotkey_20260126.log
- 日期切换：需要重启程序
- 旧日志：手动清理
- 切换bug：写入多个文件

改进后：
- 文件名：pyQuickStart_20260128.log
- 日期切换：0点后自动切换
- 旧日志：自动清理（保留7天）
- 切换bug：已修复，只写入新文件
```

## 🔧 技术改进

1. **Logger重构**
   - 不使用basicConfig，手动配置logger
   - 创建独立logger实例（pyQuickStart）
   - 保存file_handler引用，确保正确关闭

2. **进程检测优化**
   - 收集所有候选进程，按启动时间排序
   - 只添加最早启动的进程（主进程）
   - 支持现有进程的检测和添加

3. **防锁屏机制**
   - 四重防护：按键模拟 → 鼠标移动 → 重置计时器 → 恢复状态
   - 更长的延迟时间确保系统识别
   - 使用不影响用户的功能键

## 📦 安装说明

### 方式一：直接下载（推荐）
1. 下载 [pyQuickStart.exe](https://gitee.com/sytao_2020/pyQuickStart/releases/download/v2.0.1/pyQuickStart.exe)
2. 右键选择"以管理员身份运行"
3. 开始使用！

### 方式二：自动更新
如果你已经安装了 v2.0.0：
1. 打开程序
2. 点击右上角的 🔄 按钮
3. 点击"立即更新"
4. 程序会自动下载并安装新版本

## ⚠️ 注意事项

1. **必须以管理员权限运行**（否则快捷键无法生效）
2. 旧版本的日志文件（hotkey_*.log）会在7天后自动清理
3. 如果遇到问题，请查看日志文件：`logs/pyQuickStart_yyyymmdd.log`

## 🔗 相关链接

- Gitee仓库：https://gitee.com/sytao_2020/pyQuickStart
- GitHub仓库：https://github.com/ytSuen/pyQuickStart
- 问题反馈：https://gitee.com/sytao_2020/pyQuickStart/issues

## 📊 版本对比

| 功能 | v2.0.0 | v2.0.1 |
|------|--------|--------|
| 防锁屏可靠性 | 一般 | 优秀 |
| 进程统计准确性 | 错误 | 准确 |
| 日志管理 | 基础 | 完善 |
| 日志自动切换 | ❌ | ✅ |
| 日志自动清理 | ❌ | ✅ |
| 应用图标 | ❌ | ✅ |

## 🙏 致谢

感谢所有用户的反馈和建议！

---

**完整更新日志**：[CHANGELOG.md](./CHANGELOG.md)
